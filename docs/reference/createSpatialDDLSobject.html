<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a SpatialDDLS object — createSpatialDDLSobject • SpatialDDLS</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Create a SpatialDDLS object — createSpatialDDLSobject"><meta property="og:description" content="Create a SpatialDDLS object by providing single-cell
RNA-seq data. Additionally, spatial transcriptomics data contained in
SpatialDDLS objects can also be provided. It is
recommended to provide both types of data to only use genes shared between
both experiments."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SpatialDDLS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href=".././articles/realModelExample-hq.html">Deconvolution of mouse lymph node samples</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/diegommcc/SpatialDDLS" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a <code><a href="SpatialDDLS-class.html">SpatialDDLS</a></code> object</h1>
    <small class="dont-index">Source: <a href="https://github.com/diegommcc/SpatialDDLS/R/loadData.R" class="external-link"><code>R/loadData.R</code></a></small>
    <div class="hidden name"><code>createSpatialDDLSobject.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a <code><a href="SpatialDDLS-class.html">SpatialDDLS</a></code> object by providing single-cell
RNA-seq data. Additionally, spatial transcriptomics data contained in
<code><a href="SpatialDDLS-class.html">SpatialDDLS</a></code> objects can also be provided. It is
recommended to provide both types of data to only use genes shared between
both experiments.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">createSpatialDDLSobject</span><span class="op">(</span></span>
<span>  <span class="va">sc.data</span>,</span>
<span>  <span class="va">sc.cell.ID.column</span>,</span>
<span>  <span class="va">sc.cell.type.column</span>,</span>
<span>  <span class="va">sc.gene.ID.column</span>,</span>
<span>  <span class="va">st.data</span>,</span>
<span>  <span class="va">st.spot.ID.column</span>,</span>
<span>  <span class="va">st.gene.ID.column</span>,</span>
<span>  sc.filt.genes.cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sc.min.mean.counts <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sc.n.genes.per.cluster <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  top.n.genes <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  sc.min.counts <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sc.min.cells <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  st.min.counts <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  st.min.spots <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  st.n.slides <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  shared.genes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sc.name.dataset.h5 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc.file.backend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc.name.dataset.backend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc.compression.level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc.chunk.dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sc.block.processing <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  project <span class="op">=</span> <span class="st">"SpatialDDLS-Proj"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sc.data</dt>
<dd><p>Single-cell RNA-seq profiles to be used as reference. If data
are provided from files, <code>single.cell.real</code> must be a vector of three
elements: single-cell counts, cells metadata and genes metadata. On the
other hand, If data are provided from a
<code>SingleCellExperiment</code> object, single-cell counts must
be present in the <code>assay</code> slot, cells metadata in the <code>colData</code>
slot, and genes metadata in the <code>rowData</code> slot.</p></dd>


<dt>sc.cell.ID.column</dt>
<dd><p>Name or number of the column in cells metadata
corresponding to cell names in expression matrix (single-cell RNA-seq
data).</p></dd>


<dt>sc.cell.type.column</dt>
<dd><p>Name or column number corresponding to cell types
in cells metadata.</p></dd>


<dt>sc.gene.ID.column</dt>
<dd><p>Name or number of the column in genes metadata
corresponding to the names used for features/genes (single-cell RNA-seq
data).</p></dd>


<dt>st.data</dt>
<dd><p>Spatial transcriptomics datasets to be deconvoluted. It can be
a single <code>SpatialExperiment</code> object or a list of them.</p></dd>


<dt>st.spot.ID.column</dt>
<dd><p>Name or number of the column in spots metadata
corresponding to spot names in expression matrix (spatial transcriptomics
data).</p></dd>


<dt>st.gene.ID.column</dt>
<dd><p>Name or number of the column in the genes metadata
corresponding to the names used for features/genes (spatial transcriptomics
data).</p></dd>


<dt>sc.filt.genes.cluster</dt>
<dd><p>Whether to filter single-cell RNA-seq genes
according to a minimum threshold of non-zero average counts per cell type
(<code>sc.min.mean.counts</code>). <code>TRUE</code> by default.</p></dd>


<dt>sc.min.mean.counts</dt>
<dd><p>Minimum non-zero average counts per cluster to
filter genes. 1 by default.</p></dd>


<dt>sc.n.genes.per.cluster</dt>
<dd><p>Top n genes with the highest logFC per cluster.
300 by default. See Details section for more details.</p></dd>


<dt>top.n.genes</dt>
<dd><p>Maximum number of genes used for downstream steps (2000
by default). In case the number of genes after filtering is greater than
<code>top.n.genes</code>, these genes will be set according to
variability across the whole single-cell dataset.</p></dd>


<dt>sc.min.counts</dt>
<dd><p>Minimum gene counts to filter (0 by default; single-cell
RNA-seq data).</p></dd>


<dt>sc.min.cells</dt>
<dd><p>Minimum of cells with more than <code>min.counts</code> (0 by
default; single-cell RNA-seq data).</p></dd>


<dt>st.min.counts</dt>
<dd><p>Minimum gene counts to filter (0 by default; spatial
transcriptomics data).</p></dd>


<dt>st.min.spots</dt>
<dd><p>Minimum of cells with more than <code>min.counts</code> (0 by
default; spatial transcriptomics data).</p></dd>


<dt>st.n.slides</dt>
<dd><p>Minimum number of slides
(<code>SpatialExperiment</code> objects) in which a gene has to be
expressed in order to keep it. This parameter is applicable only when
multiple <code>SpatialExperiment</code> objects are provided. Genes
not present in at least <code>st.n.slides</code> will be discarded. If no
filtering is desired, set <code>st.n.slides = 1</code>.</p></dd>


<dt>shared.genes</dt>
<dd><p>If set to <code>TRUE</code>, only genes present in both the
isngle-cell and spatial transcriptomics data will be retained for further
processing (<code>TRUE</code> by default).</p></dd>


<dt>sc.name.dataset.h5</dt>
<dd><p>Name of the data set if HDF5 file is provided for
single-cell RNA-seq data.</p></dd>


<dt>sc.file.backend</dt>
<dd><p>Valid file path where to store the loaded for
single-cell RNA-seq data as HDF5 file. If provided, data are stored in a
HDF5 file as back-end using the <span class="pkg">DelayedArray</span> and <span class="pkg">HDF5Array</span>
packages instead of being loaded into RAM. This is suitable for situations
where you have large amounts of data that cannot be stored in memory. Note
that operations on these data will be performed by blocks (i.e subsets of
determined size), which may result in longer execution times. <code>NULL</code>
by default.</p></dd>


<dt>sc.name.dataset.backend</dt>
<dd><p>Name of the HDF5 file dataset to be used. Note
that it cannot exist. If <code>NULL</code> (by default), a random dataset name
will be generated.</p></dd>


<dt>sc.compression.level</dt>
<dd><p>The compression level used if
<code>sc.file.backend</code> is provided. It is an integer value between 0 (no
compression) and 9 (highest and slowest compression). See
<code>?<a href="https://rdrr.io/pkg/HDF5Array/man/dump-management.html" class="external-link">getHDF5DumpCompressionLevel</a></code> from the
<span class="pkg">HDF5Array</span> package for more information.</p></dd>


<dt>sc.chunk.dims</dt>
<dd><p>Specifies dimensions that HDF5 chunk will have. If
<code>NULL</code>, the default value is a vector of two items: the number of
genes considered by <code><a href="SpatialDDLS-class.html">SpatialDDLS</a></code> object during the
simulation, and only one sample in order to increase read times in the
following steps. A larger number of columns written in each chunk may lead
to longer read times.</p></dd>


<dt>sc.block.processing</dt>
<dd><p>Boolean indicating whether single-cell RNA-seq
data should be treated as blocks (only if data are provided as HDF5 file).
<code>FALSE</code> by default. Note that using this functionality is suitable for
cases where it is not possible to load data into RAM and therefore
execution times will be longer.</p></dd>


<dt>verbose</dt>
<dd><p>Show informative messages during the execution (<code>TRUE</code> by
default).</p></dd>


<dt>project</dt>
<dd><p>Name of the project for <code><a href="SpatialDDLS-class.html">SpatialDDLS</a></code>
object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="SpatialDDLS-class.html">SpatialDDLS</a></code> object with the single-cell
RNA-seq data provided loaded into the <code>single.cell.real</code> slot as a
<code>SingleCellExperiment</code> object. If spatial
transcriptomics data are provided, they will be loaded into the
<code>spatial.experiments</code> slot.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Filtering genes</strong></p>
<p>In order to reduce the number of dimensions used for subsequent steps,
<code>createSpatialDDLSobject</code> implements different strategies aimed at
removing useless genes for deconvolution:</p><ul><li><p>Filtering at the
cell level: genes less expressed than a determined cutoff in N cells are
removed. See <code>sc.min.cells</code>/<code>st.min.cells</code> and
<code>sc.min.counts</code>/<code>st.min.cells</code> parameters.</p></li>
<li><p>Filtering at the
cluster level (only for scRNA-seq data): if
<code>sc.filt.genes.cluster == TRUE</code>, <code>createSpatialDDLSobject</code> sets a
cutoff of non-zero average counts per
cluster (<code>sc.min.mean.counts</code> parameter) and take only the
<code>sc.n.genes.per.cluster</code> genes with the highest logFC per cluster.
LogFCs are calculated using normalized logCPM of each cluster with respect to
the average in the whole dataset). Finally, if
the number of remaining genes is greater than <code>top.n.genes</code>, genes are
ranked based on variance and the <code>top.n.genes</code> most variable genes are
used for downstream analyses.</p></li>
</ul><p><strong>Single-cell RNA-seq data</strong></p>
<p>Single-cell RNA-seq data can be provided from files (formats allowed: tsv,
tsv.gz, mtx (sparse matrix) and hdf5) or a
<code>SingleCellExperiment</code> object. Data will be stored in the
<code>single.cell.real</code> slot, and must consist of three pieces of
information:</p><ul><li><p>Single-cell counts: genes as rows and cells as
columns.</p></li>
<li><p>Cells metadata: annotations (columns) for each cell (rows).</p></li>
<li><p>Genes metadata: annotations (columns) for each gene (rows).</p></li>
</ul><p>If data
are provided from files, <code>single.cell.real</code> argument must be a vector of
three elements ordered so that the first file corresponds to the count
matrix, the second to the cells metadata, and the last to the genes metadata.
On the other hand, if data are provided as a
<code>SingleCellExperiment</code> object, it must contain single-cell
counts in <code>assay</code>, cells metadata in <code>colData</code>, and genes metadata
in <code>rowData</code>. Data must be provided without any transformation (e.g.
log-transformation), raw counts are preferred.</p>
<p><strong>Spatial transcriptomics data</strong></p>
<p>It must be a <code>SpatialExperiment</code> object (or a list of them
if more than one slide is going to be deconvoluted) containing the same
information as the single-cell RNA-seq data: the count matrix, spots
metadata, and genes metadata. Please, make sure the gene identifiers used the
spatial and single-cell transcriptomics data are consistent.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="estimateZinbwaveParams.html">estimateZinbwaveParams</a></code> <code><a href="genMixedCellProp.html">genMixedCellProp</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu">SingleCellExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/SingleCellExperiment.html" class="external-link">SingleCellExperiment</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    counts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">40</span>, ncol <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>      dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"RHC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Cell_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"RHC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Cell_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CellType"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>                       replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  rowData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Gene_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">30</span>, lambda <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Spot"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coordinates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ste</span> <span class="op">&lt;-</span> <span class="fu">SpatialExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment.html" class="external-link">SpatialExperiment</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>counts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rowData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Gene_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Gene"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  colData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Cell_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Spot"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  spatialCoords <span class="op">=</span> <span class="va">coordinates</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SDDLS</span> <span class="op">&lt;-</span> <span class="fu">createSpatialDDLSobject</span><span class="op">(</span></span></span>
<span class="r-in"><span>  sc.data <span class="op">=</span> <span class="va">sce</span>,</span></span>
<span class="r-in"><span>  sc.cell.ID.column <span class="op">=</span> <span class="st">"Cell_ID"</span>,</span></span>
<span class="r-in"><span>  sc.gene.ID.column <span class="op">=</span> <span class="st">"Gene_ID"</span>,</span></span>
<span class="r-in"><span>  st.data <span class="op">=</span> <span class="va">ste</span>,</span></span>
<span class="r-in"><span>  st.spot.ID.column <span class="op">=</span> <span class="st">"Cell_ID"</span>,</span></span>
<span class="r-in"><span>  st.gene.ID.column <span class="op">=</span> <span class="st">"Gene_ID"</span>,</span></span>
<span class="r-in"><span>  project <span class="op">=</span> <span class="st">"Simul_example"</span>,</span></span>
<span class="r-in"><span>  sc.filt.genes.cluster <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> === 1 SpatialExperiment objects provided</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    === Processing spatial transcriptomics data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       - Filtering features:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>          - Selected features: 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>          - Discarded features: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> === Processing single-cell data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       - Filtering features:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>          - Selected features: 40</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>          - Discarded features: 0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> === Number of shared genes between single-cell and spatial transcriptomics datasets: 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Original # genes in single-cell data: 40</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     - Original # genes in ST data (object with the greatest # genes): 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> === Final number of dimensions for further analyses: 5</span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/diegommcc" class="external-link">Diego Mañanes</a>, <a href="https://www.cnic.es/en/carlos-torroja" class="external-link">Carlos Torroja</a>, <a href="https://www.cnic.es/en/fatima-sanchez-cabo" class="external-link">Fatima Sanchez-Cabo</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

